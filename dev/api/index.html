<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API · TransitionMatrices.jl</title><script data-outdated-warner src="../assets/warner.js"></script><link rel="canonical" href="https://lucifer1004.github.io/TransitionMatrices.jl/api/"/><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.045/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.13.24/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL=".."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../assets/documenter.js"></script><script src="../siteinfo.js"></script><script src="../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="../">TransitionMatrices.jl</a></span></div><form class="docs-search" action="../search/"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="../">Home</a></li><li class="is-active"><a class="tocitem" href>API</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href>API</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>API</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/main/docs/src/api.md#" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="API"><a class="docs-heading-anchor" href="#API">API</a><a id="API-1"></a><a class="docs-heading-anchor-permalink" href="#API" title="Permalink"></a></h1><ul><li><a href="#TransitionMatrices.AbstractTransitionMatrix"><code>TransitionMatrices.AbstractTransitionMatrix</code></a></li><li><a href="#TransitionMatrices.Chebyshev"><code>TransitionMatrices.Chebyshev</code></a></li><li><a href="#TransitionMatrices.Cylinder"><code>TransitionMatrices.Cylinder</code></a></li><li><a href="#TransitionMatrices.MieTransitionMatrix"><code>TransitionMatrices.MieTransitionMatrix</code></a></li><li><a href="#TransitionMatrices.OrderDegreeIterator"><code>TransitionMatrices.OrderDegreeIterator</code></a></li><li><a href="#TransitionMatrices.RandomOrientationTransitionMatrix-Union{Tuple{AbstractTransitionMatrix{CT, N}}, Tuple{N}, Tuple{CT}} where {CT, N}"><code>TransitionMatrices.RandomOrientationTransitionMatrix</code></a></li><li><a href="#TransitionMatrices.Spheroid"><code>TransitionMatrices.Spheroid</code></a></li><li><a href="#TransitionMatrices.TransitionMatrix"><code>TransitionMatrices.TransitionMatrix</code></a></li><li><a href="#TransitionMatrices.absorption_cross_section"><code>TransitionMatrices.absorption_cross_section</code></a></li><li><a href="#TransitionMatrices.albedo-Tuple{AbstractTransitionMatrix}"><code>TransitionMatrices.albedo</code></a></li><li><a href="#TransitionMatrices.amplitude_matrix-Union{Tuple{T}, Tuple{V}, Tuple{N}, Tuple{CT}, Tuple{AxisymmetricTransitionMatrix{CT, N, V, T}, Any, Any, Any, Any}} where {CT, N, V, T}"><code>TransitionMatrices.amplitude_matrix</code></a></li><li><a href="#TransitionMatrices.amplitude_matrix-Union{Tuple{N}, Tuple{CT}, Tuple{AbstractTransitionMatrix{CT, N}, Any, Any, Any, Any}} where {CT, N}"><code>TransitionMatrices.amplitude_matrix</code></a></li><li><a href="#TransitionMatrices.bhcoat-NTuple{5, Any}"><code>TransitionMatrices.bhcoat</code></a></li><li><a href="#TransitionMatrices.bhmie-Tuple{Any, Any, Any}"><code>TransitionMatrices.bhmie</code></a></li><li><a href="#TransitionMatrices.extinction_cross_section-Union{Tuple{AxisymmetricTransitionMatrix{CT, N, V, T}}, Tuple{T}, Tuple{V}, Tuple{N}, Tuple{CT}, Tuple{AxisymmetricTransitionMatrix{CT, N, V, T}, Any}} where {CT, N, V, T}"><code>TransitionMatrices.extinction_cross_section</code></a></li><li><a href="#TransitionMatrices.extinction_cross_section-Union{Tuple{AbstractTransitionMatrix{CT, N}}, Tuple{N}, Tuple{CT}, Tuple{AbstractTransitionMatrix{CT, N}, Any}} where {CT, N}"><code>TransitionMatrices.extinction_cross_section</code></a></li><li><a href="#TransitionMatrices.factorial-Union{Tuple{T}, Tuple{Type{T}, Any}} where T"><code>TransitionMatrices.factorial</code></a></li><li><a href="#TransitionMatrices.gausslegendre-Tuple{Type{Float64}, Integer}"><code>TransitionMatrices.gausslegendre</code></a></li><li><a href="#TransitionMatrices.gaussquad-Union{Tuple{T}, Tuple{Spheroid{T}, Any}} where T"><code>TransitionMatrices.gaussquad</code></a></li><li><a href="#TransitionMatrices.gaussquad-Union{Tuple{T}, Tuple{Cylinder{T}, Any}} where T"><code>TransitionMatrices.gaussquad</code></a></li><li><a href="#TransitionMatrices.gaussquad-Union{Tuple{T}, Tuple{Chebyshev{T}, Any}} where T"><code>TransitionMatrices.gaussquad</code></a></li><li><a href="#TransitionMatrices.order-Union{Tuple{AbstractTransitionMatrix{CT, N}}, Tuple{N}, Tuple{CT}} where {CT, N}"><code>TransitionMatrices.order</code></a></li><li><a href="#TransitionMatrices.orientation_average-Tuple{MieTransitionMatrix, Any}"><code>TransitionMatrices.orientation_average</code></a></li><li><a href="#TransitionMatrices.orientation_average-Union{Tuple{N}, Tuple{CT}, Tuple{AbstractTransitionMatrix{CT, N}, Any}} where {CT, N}"><code>TransitionMatrices.orientation_average</code></a></li><li><a href="#TransitionMatrices.orientation_average-Tuple{RandomOrientationTransitionMatrix, Any}"><code>TransitionMatrices.orientation_average</code></a></li><li><a href="#TransitionMatrices.phase_matrix-Tuple{AbstractMatrix}"><code>TransitionMatrices.phase_matrix</code></a></li><li><a href="#TransitionMatrices.pi_func-Union{Tuple{T}, Tuple{Type{T}, Integer, Integer, Number}} where T"><code>TransitionMatrices.pi_func</code></a></li><li><a href="#TransitionMatrices.ricattibesselj-Tuple{Integer, Integer, Any}"><code>TransitionMatrices.ricattibesselj</code></a></li><li><a href="#TransitionMatrices.ricattibesselj!-NTuple{6, Any}"><code>TransitionMatrices.ricattibesselj!</code></a></li><li><a href="#TransitionMatrices.ricattibessely-Tuple{Any, Any}"><code>TransitionMatrices.ricattibessely</code></a></li><li><a href="#TransitionMatrices.ricattibessely!-NTuple{4, Any}"><code>TransitionMatrices.ricattibessely!</code></a></li><li><a href="#TransitionMatrices.rotate-Tuple{MieTransitionMatrix, Rotations.Rotation{3}}"><code>TransitionMatrices.rotate</code></a></li><li><a href="#TransitionMatrices.rotate-Union{Tuple{N}, Tuple{CT}, Tuple{AbstractTransitionMatrix{CT, N}, Rotations.Rotation{3}}} where {CT, N}"><code>TransitionMatrices.rotate</code></a></li><li><a href="#TransitionMatrices.rotate-Union{Tuple{V}, Tuple{N}, Tuple{CT}, Tuple{RandomOrientationTransitionMatrix{CT, N, V}, Rotations.Rotation{3}}} where {CT, N, V}"><code>TransitionMatrices.rotate</code></a></li><li><a href="#TransitionMatrices.scattering_cross_section-Union{Tuple{AxisymmetricTransitionMatrix{CT, N, V, T}}, Tuple{T}, Tuple{V}, Tuple{N}, Tuple{CT}, Tuple{AxisymmetricTransitionMatrix{CT, N, V, T}, Any}} where {CT, N, V, T}"><code>TransitionMatrices.scattering_cross_section</code></a></li><li><a href="#TransitionMatrices.scattering_cross_section-Union{Tuple{AbstractTransitionMatrix{CT, N}}, Tuple{N}, Tuple{CT}, Tuple{AbstractTransitionMatrix{CT, N}, Any}} where {CT, N}"><code>TransitionMatrices.scattering_cross_section</code></a></li><li><a href="#TransitionMatrices.tau_func-Union{Tuple{T}, Tuple{Type{T}, Integer, Integer, Number}} where T"><code>TransitionMatrices.tau_func</code></a></li><li><a href="#TransitionMatrices.transition_matrix-Union{Tuple{CT}, Tuple{T}, Tuple{AbstractAxisymmetricShape{T, CT}, Any, Any, Any}} where {T, CT}"><code>TransitionMatrices.transition_matrix</code></a></li><li><a href="#TransitionMatrices.transition_matrix_m-Union{Tuple{CT}, Tuple{T}, Tuple{Any, AbstractAxisymmetricShape{T, CT}, Any, Any, Any}} where {T, CT}"><code>TransitionMatrices.transition_matrix_m</code></a></li><li><a href="#TransitionMatrices.transition_matrix_m₀-Union{Tuple{CT}, Tuple{T}, Tuple{AbstractAxisymmetricShape{T, CT}, Any, Any, Any}} where {T, CT}"><code>TransitionMatrices.transition_matrix_m₀</code></a></li><li><a href="#TransitionMatrices.wigner_D-Union{Tuple{T}, Tuple{Type{T}, Integer, Integer, Integer, Number, Number, Number}} where T"><code>TransitionMatrices.wigner_D</code></a></li><li><a href="#TransitionMatrices.wigner_D_recursion-Union{Tuple{T}, Tuple{Type{T}, Integer, Integer, Integer, Number, Number, Number}} where T"><code>TransitionMatrices.wigner_D_recursion</code></a></li><li><a href="#TransitionMatrices.wigner_D_recursion!-Union{Tuple{CT}, Tuple{AbstractVector{CT}, Integer, Integer, Integer, Number, Number, Number}} where CT"><code>TransitionMatrices.wigner_D_recursion!</code></a></li><li><a href="#TransitionMatrices.wigner_d-Union{Tuple{T}, Tuple{Type{T}, Integer, Integer, Integer, Number}} where T"><code>TransitionMatrices.wigner_d</code></a></li><li><a href="#TransitionMatrices.wigner_d_recursion-Union{Tuple{T}, Tuple{Type{T}, Integer, Integer, Integer, Number}} where T"><code>TransitionMatrices.wigner_d_recursion</code></a></li><li><a href="#TransitionMatrices.wigner_d_recursion!-Union{Tuple{T}, Tuple{AbstractVector{T}, Integer, Integer, Integer, Number}} where T"><code>TransitionMatrices.wigner_d_recursion!</code></a></li></ul><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.AbstractTransitionMatrix" href="#TransitionMatrices.AbstractTransitionMatrix"><code>TransitionMatrices.AbstractTransitionMatrix</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A general T-Matrix <span>$T_{m n m^{\prime} n^{\prime}}^{k l}$</span> stored in a 6-dimensional array, in the order <span>$(m, n, m^{\prime}, n^{\prime}, k, l)$</span>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/common/AbstractTransitionMatrix.jl#L1-L3">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.Chebyshev" href="#TransitionMatrices.Chebyshev"><code>TransitionMatrices.Chebyshev</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A Chebyshev scatterer defined by</p><p class="math-container">\[r(\theta, \phi)=r_0(1+\varepsilon T_n(\cos\theta))\]</p><p>where <span>$T_n(\cos\theta)=\cos n\theta$</span>.</p><p>Attributes:</p><ul><li><code>r₀</code>: the radius of the base sphere.</li><li><code>ε</code>: the deformation parameter, which satisfies <span>$-1\le\varepsilon&lt;1$</span>.</li><li><code>n</code>: the degree of the Chebyshev polynomial.</li><li><code>m</code>: the relative complex refractive index.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/shapes/chebyshev.jl#L1-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.Cylinder" href="#TransitionMatrices.Cylinder"><code>TransitionMatrices.Cylinder</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A cylindrical scatterer.</p><p>Attributes:</p><ul><li><code>r</code>: the radius of the cylinder base.</li><li><code>h</code>: the height of the cylinder.</li><li><code>m</code>: the relative complex refractive index.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/shapes/cylinder.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.MieTransitionMatrix" href="#TransitionMatrices.MieTransitionMatrix"><code>TransitionMatrices.MieTransitionMatrix</code></a> — <span class="docstring-category">Type</span></header><section><div><p>According to Eq. (5.42) – Eq. (5.44) in Mishchenko et al. (2002), the T-Matrix for a Mie particle can be written as:</p><p class="math-container">\[\begin{array}{l}
T_{m n m^{\prime} n^{\prime}}^{12}(P) \equiv 0, \quad T_{m n m^{\prime} n^{\prime}}^{21}(P) \equiv 0, \\
T_{m n m^{\prime} n^{\prime}}^{11}(P)=-\delta_{m m^{\prime}} \delta_{n n^{\prime}} b_n, \\
T_{m n m^{\prime} n^{\prime}}^{22}(P)=-\delta_{m m^{\prime}} \delta_{n n^{\prime}} a_n .
\end{array}\]</p><pre><code class="nohighlight hljs">MieTransitionMatrix{CT, N}(x::Real, m::Number)</code></pre><p>Generate the T-Matrix from the Mie coefficients of a homogeneous sphere.</p><pre><code class="nohighlight hljs">MieTransitionMatrix{CT, N}(x_core::Real, x_mantle::Real, m_core::Number, m_mantle::Number)</code></pre><p>Generate the T-Matrix from the Mie coefficients of a coated sphere.</p><p>This struct provides the T-Matrix API for a Mie particle.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/Mie/MieTransitionMatrix.jl#L1-L25">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.OrderDegreeIterator" href="#TransitionMatrices.OrderDegreeIterator"><code>TransitionMatrices.OrderDegreeIterator</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Iterator for the order-degree pairs of the given maximum order <code>nₘₐₓ</code>.</p><p>Example of <code>nₘₐₓ=2</code>:</p><pre><code class="language-julia-repl hljs">julia&gt; collect(OrderDegreeIterator(2))
8-element Vector{Tuple{Int64, Int64}}:
 (1, -1)
 (1, 0)
 (1, 1)
 (2, -2)
 (2, -1)
 (2, 0)
 (2, 1)
 (2, 2)</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/common/utils.jl#L1-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.RandomOrientationTransitionMatrix-Union{Tuple{AbstractTransitionMatrix{CT, N}}, Tuple{N}, Tuple{CT}} where {CT, N}" href="#TransitionMatrices.RandomOrientationTransitionMatrix-Union{Tuple{AbstractTransitionMatrix{CT, N}}, Tuple{N}, Tuple{CT}} where {CT, N}"><code>TransitionMatrices.RandomOrientationTransitionMatrix</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">RandomOrientationTransitionMatrix(𝐓::AbstractTransitionMatrix{CT, N}) where {CT, N}</code></pre><p>Calculate the random-orientation T-Matrix according to Eq. (5.96) in Mishchenko et al. (2002).</p><p class="math-container">\[\left\langle T_{m n m^{\prime} n^{\prime}}^{k l}(L)\right\rangle=\frac{\delta_{n n^{\prime}} \delta_{m m^{\prime}}}{2 n+1} \sum_{m_1=-n}^n T_{m_1 n m_1 n}^{k l}(P), \quad k, l=1,2\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/common/RandomOrientationTransitionMatrix.jl#L6-L16">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.Spheroid" href="#TransitionMatrices.Spheroid"><code>TransitionMatrices.Spheroid</code></a> — <span class="docstring-category">Type</span></header><section><div><p>A spheroidal scatterer.</p><p>Attributes:</p><ul><li><code>a</code>: the length of the semi-major axis.</li><li><code>c</code>: the length of the semi-minor axis.</li><li><code>m</code>: the relative complex refractive index.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/shapes/spheroid.jl#L1-L9">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.TransitionMatrix" href="#TransitionMatrices.TransitionMatrix"><code>TransitionMatrices.TransitionMatrix</code></a> — <span class="docstring-category">Type</span></header><section><div><p>Concrete type for a general T-Matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/common/AbstractTransitionMatrix.jl#L16-L18">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.absorption_cross_section" href="#TransitionMatrices.absorption_cross_section"><code>TransitionMatrices.absorption_cross_section</code></a> — <span class="docstring-category">Function</span></header><section><div><pre><code class="language-julia hljs">absorption_cross_section(𝐓::AbstractTransitionMatrix, λ=2π)</code></pre><p>Calculate the absorption cross section from the given T-Matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/common/utils.jl#L128-L134">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.albedo-Tuple{AbstractTransitionMatrix}" href="#TransitionMatrices.albedo-Tuple{AbstractTransitionMatrix}"><code>TransitionMatrices.albedo</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">albedo(𝐓::AbstractTransitionMatrix)</code></pre><p>Calculate the single scattering albedo from the given T-Matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/common/utils.jl#L101-L107">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.amplitude_matrix-Union{Tuple{N}, Tuple{CT}, Tuple{AbstractTransitionMatrix{CT, N}, Any, Any, Any, Any}} where {CT, N}" href="#TransitionMatrices.amplitude_matrix-Union{Tuple{N}, Tuple{CT}, Tuple{AbstractTransitionMatrix{CT, N}, Any, Any, Any, Any}} where {CT, N}"><code>TransitionMatrices.amplitude_matrix</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">amplitude_matrix(𝐓::AbstractTransitionMatrix{CT, N}, ϑᵢ, φᵢ, ϑₛ, φₛ; λ=2π)</code></pre><p>Calculate the amplitude matrix of the given T-Matrix <code>𝐓</code> at the given incidence and scattering angles. </p><p>Parameters:</p><ul><li><code>𝐓</code>: the T-Matrix of the scatterer.</li><li><code>ϑᵢ</code>: the incidence zenith angle in radians.</li><li><code>φᵢ</code>: the incidence azimuthal angle in radians.</li><li><code>ϑₛ</code>: the scattering zenith angle in radians.</li><li><code>φₛ</code>: the scattering azimuthal angle in radians.</li><li><code>λ</code>: the wavelength of the incident wave in the host medium. Default to 2π.</li></ul><p>For a general T-Matrix, Eq. (5.11) – Eq. (5.17) in Mishchenko et al. (2002) is used as a fallback.</p><p class="math-container">\[\begin{array}{l}
S_{11}\left(\hat{\mathbf{n}}^{\text {sca }}, \hat{\mathbf{n}}^{\text {inc }}\right)=\frac{1}{k_1} \sum_{n=1}^{\infty} \sum_{n^{\prime}=1}^{\infty} \sum_{m=-n}^n \sum_{m^{\prime}=-n^{\prime}}^{n^{\prime}} \alpha_{m n m^{\prime} n^{\prime}}\left[T_{m n m^{\prime} n^{\prime}}^{11} \pi_{m n}\left(\vartheta^{\text {sca }}\right) \pi_{m^{\prime} n^{\prime}}\left(\vartheta^{\text {inc }}\right)\right. \\
+T_{m n m^{\prime} n^{\prime}}^{21} \tau_{m n}\left(\vartheta^{\text {sca }}\right) \pi_{m^{\prime} n^{\prime}}\left(\vartheta^{\mathrm{inc}}\right)+T_{m n m^{\prime} n^{\prime}}^{12} \pi_{m n}\left(\vartheta^{\text {sca }}\right) \tau_{m^{\prime} n^{\prime}}\left(\vartheta^{\mathrm{inc}}\right) \\
\left.+T_{m n m^{\prime} n^2}^{22} \tau_{m n}\left(\vartheta^{\text {sca }}\right) \tau_{m^{\prime} n^{\prime}}\left(\vartheta^{\text {inc }}\right)\right] \exp \left[\mathrm{i}\left(m \varphi^{\text {sca }}-m^{\prime} \varphi^{\text {inc }}\right)\right] \text {, } \\
S_{12}\left(\hat{\mathbf{n}}^{\mathrm{sca}}, \hat{\mathbf{n}}^{\mathrm{inc}}\right)=\frac{1}{\mathrm{i} k_1} \sum_{n=1}^{\infty} \sum_{n^{\prime}=1}^{\infty} \sum_{m=-n}^n \sum_{m^{\prime}=-n^{\prime}}^{n^{\prime}} \alpha_{m n m^{\prime} n^{\prime}}\left[T_{m n m^{\prime} n^{\prime}}^{11} \pi_{m n}\left(\vartheta^{\mathrm{sca}}\right) \tau_{m^{\prime} n^{\prime}}\left(\vartheta^{\mathrm{inc}}\right)\right. \\
+T_{m n m^{\prime} n^{\prime}}^{21} \tau_{m n}\left(\vartheta^{\text {sca }}\right) \tau_{m^{\prime} n^{\prime}}\left(\vartheta^{\mathrm{inc}}\right)+T_{m n m^{\prime} n^{\prime}}^{12} \pi_{m n}\left(\vartheta^{\text {sca }}\right) \pi_{m^{\prime} n^{\prime}}\left(\vartheta^{\text {inc }}\right) \\
\left.+T_{m n m^{\prime} n^{\prime}}^{22} \tau_{m n}\left(\vartheta^{\text {sca }}\right) \pi_{m^{\prime} n^{\prime}}\left(\vartheta^{\text {inc }}\right)\right] \exp \left[\mathrm{i}\left(m \varphi^{\text {sca }}-m^{\prime} \varphi^{\text {inc }}\right)\right] \text {, } \\
S_{21}\left(\hat{\mathbf{n}}^{\mathrm{sca}}, \hat{\mathbf{n}}^{\mathrm{inc}}\right)=\frac{\mathrm{i}}{k_1} \sum_{n=1}^{\infty} \sum_{n^{\prime}=1}^{\infty} \sum_{m=-n}^n \sum_{m^{\prime}=-n^{\prime}}^{n^{\prime}} \alpha_{m n m^{\prime} n^{\prime}}\left[T_{m n m^{\prime} n^{\prime}}^{11} \tau_{m n}\left(\vartheta^{\mathrm{sca}}\right) \pi_{m^{\prime} n^{\prime}}\left(\vartheta^{\mathrm{inc}}\right)\right. \\
+T_{m n m^{\prime} n^{\prime}}^{21} \pi_{m n}\left(\vartheta^{\text {sca }}\right) \pi_{m^{\prime} n^{\prime}}\left(\vartheta^{\mathrm{inc}}\right)+T_{m n m^{\prime} n^{\prime}}^{12} \tau_{m n}\left(\vartheta^{\text {sca }}\right) \tau_{m^{\prime} n^{\prime}}\left(\vartheta^{\text {inc }}\right) \\
\left.+T_{m n m^{\prime} n^{\prime}}^{22} \pi_{m n}\left(\vartheta^{\text {sca }}\right) \tau_{m^{\prime} n^{\prime}}\left(\vartheta^{\text {inc }}\right)\right] \exp \left[\mathrm{i}\left(m \varphi^{\text {sca }}-m^{\prime} \varphi^{\text {inc }}\right)\right] \text {, } \\
S_{22}\left(\hat{\mathbf{n}}^{\text {sca }}, \hat{\mathbf{n}}^{\mathrm{inc}}\right)=\frac{1}{k_1} \sum_{n=1}^{\infty} \sum_{n^{\prime}=1}^{\infty} \sum_{m=-n}^n \sum_{m^{\prime}=-n^{\prime}}^{n^{\prime}} \alpha_{m n m^{\prime} n^{\prime}}\left[T_{m n n^{\prime} n^{\prime}}^{11} \tau_{m n}\left(\vartheta^{\text {sca }}\right) \tau_{m^{\prime} n^{\prime}}\left(\vartheta^{\text {inc }}\right)\right. \\
+T_{m n m^{\prime} n^{\prime}}^{21} \pi_{m n}\left(\vartheta^{\text {sca }}\right) \tau_{m^{\prime} n^{\prime}}\left(\vartheta^{\text {inc }}\right)+T_{m n m^{\prime} n^{12}}^{12} \tau_{m n}\left(\vartheta^{\text {sca }}\right) \pi_{m^{\prime} n^{\prime}}\left(\vartheta^{\text {inc }}\right) \\
\left.+T_{m n m^{\prime} n^{\prime}}^{22} \pi_{m n}\left(\vartheta^{\text {sca }}\right) \pi_{m^{\prime} n^{\prime}}\left(\vartheta^{\text {inc }}\right)\right] \exp \left[\mathrm{i}\left(m \varphi^{\text {sca }}-m^{\prime} \varphi^{\text {inc }}\right)\right], \\
\end{array}\]</p><p>Where</p><p class="math-container">\[\begin{array}{l}
\alpha_{m n m^{\prime} n^{\prime}}=\mathrm{i}^{n^{\prime}-n-1}(-1)^{m+m^{\prime}}\left[\frac{(2 n+1)\left(2 n^{\prime}+1\right)}{n(n+1) n^{\prime}\left(n^{\prime}+1\right)}\right]^{1 / 2}, \\
\pi_{m n}(\vartheta)=\frac{m d_{0 m}^n(\vartheta)}{\sin \vartheta}, \quad \pi_{-m n}(\vartheta)=(-1)^{m+1} \pi_{m n}(\vartheta), \\
\tau_{m n}(\vartheta)=\frac{\mathrm{d} d_{0 m}^n(\vartheta)}{\mathrm{d} \vartheta}, \quad \tau_{-m n}(\vartheta)=(-1)^m \tau_{m n}(\vartheta)
\end{array}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/common/AbstractTransitionMatrix.jl#L80-L124">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.amplitude_matrix-Union{Tuple{T}, Tuple{V}, Tuple{N}, Tuple{CT}, Tuple{AxisymmetricTransitionMatrix{CT, N, V, T}, Any, Any, Any, Any}} where {CT, N, V, T}" href="#TransitionMatrices.amplitude_matrix-Union{Tuple{T}, Tuple{V}, Tuple{N}, Tuple{CT}, Tuple{AxisymmetricTransitionMatrix{CT, N, V, T}, Any, Any, Any, Any}} where {CT, N, V, T}"><code>TransitionMatrices.amplitude_matrix</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">amplitude_matrix(axi::AxisymmetricTransitionMatrix{CT, N, V, T}, ϑᵢ, φᵢ, ϑₛ, φₛ;
                          λ = 2π,
                          rot::Union{Nothing, Rotation{3}} = nothing) where {CT, N, V, T}</code></pre><p>Calculate the amplitude matrix of an axisymmetric scatterer.</p><p>Parameters:</p><ul><li><code>axi</code>: the T-Matrix of the scatterer.</li><li><code>ϑᵢ</code>: the zenith angle of the incident wave.</li><li><code>φᵢ</code>: the azimuth angle of the incident wave.</li><li><code>ϑₛ</code>: the zenith angle of the scattered wave.</li><li><code>φₛ</code>: the azimuth angle of the scattered wave.</li><li><code>λ</code>: the wavelength of the incident wave in the host medium. Default to 2π.</li><li><code>rot</code>: the rotation of the scatterer.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/EBCM/axisymmetric.jl#L22-L41">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.bhcoat-NTuple{5, Any}" href="#TransitionMatrices.bhcoat-NTuple{5, Any}"><code>TransitionMatrices.bhcoat</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">bhcoat([T=Float64,], xᵢₙ, xₒᵤₜ, mᵢₙ, mₒᵤₜ; nₘₐₓ, tolerance = 1e-8)</code></pre><p>Inputs:</p><ul><li><code>T</code>: Type used for calculation. All real numbers will be stored as <code>T</code>, while complex numbers will be stored as <code>C = complex(T)</code>.</li><li><code>xᵢₙ</code>: Size parameter of the inner sphere. Defined as <span>$\frac{2\pi r}{\lambda}$</span></li><li><code>xₒᵤₜ</code>: Size parameter of the coated sphere. <code>xₒᵤₜ &gt;= xᵢₙ</code> should hold.</li><li><code>mᵢₙ</code>: Refractive index of the inner sphere, relative to the host medium.</li><li><code>mₒᵤₜ</code>: Refractive index of the mantle, relative to the host medium.</li></ul><p>Keyword arguments:</p><ul><li><code>nₘₐₓ</code>: Maximum order of the Mie coefficients. Default to <span>$\max(x_m + 4\sqrt{3}{x_m} + 2, \max(|m_c|, |m_m|)x_m)$</span>.</li><li><code>tolerance</code>: Error tolerance. Default is <code>1e-8</code>.</li></ul><p>Outputs:</p><ul><li><code>a, b</code>: Mie coefficients. Both are of type <code>Vector{C}</code>.</li></ul><p>References:</p><ul><li>Bohren, C.F., Huffman, D.R., 1983. Absorption and scattering of light by small particles. John Wiley &amp; Sons.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/Mie/bhcoat.jl#L1-L26">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.bhmie-Tuple{Any, Any, Any}" href="#TransitionMatrices.bhmie-Tuple{Any, Any, Any}"><code>TransitionMatrices.bhmie</code></a> — <span class="docstring-category">Method</span></header><section><div><p><code>bhmie([T=Float64,], x, m; nₘₐₓ)</code></p><p>This is a simplified version of Bohren (1983)&#39;s <code>bhmie</code> routine. Only the Mie coefficients are evaluated and returned.</p><p>Inputs:</p><ul><li><code>T</code>: Type used for calculation. Real numbers will be stored as <code>T</code>, while complex numbers will be stored as <code>C = complex(T)</code>.</li><li><code>x</code>: Size parameter of the sphere scatterer. Defined as <span>$\frac{2\pi r}{\lambda}$</span></li><li><code>m</code>: Relative refractive index of the scatterer.</li></ul><p>Keyword arguments:</p><ul><li><code>nₘₐₓ</code>: Maximum order of the Mie coefficients. Default to <span>$\max(x + 4\sqrt{3}{x} + 2, |m|x)$</span>.</li></ul><p>Outputs:</p><ul><li><code>a, b</code>: Mie coefficients. Both are <code>Vector{C}</code> with <code>nₘₐₓ</code> elements.</li></ul><p>References:</p><ul><li>Bohren, C.F., Huffman, D.R., 1983. Absorption and scattering of light by small particles. John Wiley &amp; Sons.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/Mie/bhmie.jl#L1-L23">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.extinction_cross_section-Union{Tuple{AbstractTransitionMatrix{CT, N}}, Tuple{N}, Tuple{CT}, Tuple{AbstractTransitionMatrix{CT, N}, Any}} where {CT, N}" href="#TransitionMatrices.extinction_cross_section-Union{Tuple{AbstractTransitionMatrix{CT, N}}, Tuple{N}, Tuple{CT}, Tuple{AbstractTransitionMatrix{CT, N}, Any}} where {CT, N}"><code>TransitionMatrices.extinction_cross_section</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">extinction_cross_section(𝐓::AbstractTransitionMatrix{CT, N}, λ=2π) where {CT, N}</code></pre><p>Calculate the extinction cross section per particle averaged over the uniform orientation distribution, according to Eq. (5.102) in Mishchenko et al. (2002).</p><p class="math-container">\[\left\langle C_{\mathrm{ext}}\right\rangle=-\frac{2 \pi}{k_1^2} \operatorname{Re} \sum_{n=1}^{\infty} \sum_{m=-n}^n\left[T_{m n n n}^{11}(P)+T_{m n m n}^{22}(P)\right]\]</p><p>Parameters:</p><ul><li><code>𝐓</code>: the T-Matrix of the scatterer.</li><li><code>λ</code>: the wavelength of the incident wave in the host medium. Default to 2π.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/common/AbstractTransitionMatrix.jl#L273-L288">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.extinction_cross_section-Union{Tuple{AxisymmetricTransitionMatrix{CT, N, V, T}}, Tuple{T}, Tuple{V}, Tuple{N}, Tuple{CT}, Tuple{AxisymmetricTransitionMatrix{CT, N, V, T}, Any}} where {CT, N, V, T}" href="#TransitionMatrices.extinction_cross_section-Union{Tuple{AxisymmetricTransitionMatrix{CT, N, V, T}}, Tuple{T}, Tuple{V}, Tuple{N}, Tuple{CT}, Tuple{AxisymmetricTransitionMatrix{CT, N, V, T}, Any}} where {CT, N, V, T}"><code>TransitionMatrices.extinction_cross_section</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">extinction_cross_section(axi::AxisymmetricTransitionMatrix{CT, N}, λ=2π) where {CT, N}</code></pre><p>Calculate the extinction cross section per particle averaged over the uniform orientation distribution, according to Eq. (5.107) in Mishchenko et al. (2002).</p><p class="math-container">\[\left\langle C_{\text {ext }}\right\rangle=-\frac{2 \pi}{k_1^2} \operatorname{Re} \sum_{n=1}^{\infty} \sum_{m=0}^n\left(2-\delta_{m 0}\right)\left[T_{m n m n}^{11}(P)+T_{m n m n}^{22}(P)\right]\]</p><p>Parameters:</p><ul><li><code>𝐓</code>: the T-Matrix of the scatterer.</li><li><code>λ</code>: the wavelength of the incident wave in the host medium. Default to 2π.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/EBCM/axisymmetric.jl#L689-L704">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.factorial-Union{Tuple{T}, Tuple{Type{T}, Any}} where T" href="#TransitionMatrices.factorial-Union{Tuple{T}, Tuple{Type{T}, Any}} where T"><code>TransitionMatrices.factorial</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">factorial([T=Float64,], n)</code></pre><p>Calculate factorials <span>$n!$</span>. For <span>$n\le20$</span>, the standard <code>Base.factorial</code> is used. For <span>$n&gt;20$</span>, <code>Arblib.gamma!</code> is used instead.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/special_functions/factorial.jl#L1-L7">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.gausslegendre-Tuple{Type{Float64}, Integer}" href="#TransitionMatrices.gausslegendre-Tuple{Type{Float64}, Integer}"><code>TransitionMatrices.gausslegendre</code></a> — <span class="docstring-category">Method</span></header><section><div><p><code>gausslegendre([T=Float64,], n)</code></p><p>Calculate the <code>n</code>-point Gauss-Legendre quadrature nodes and weights.</p><ul><li>For <code>Float64</code>, we use the <span>$\mathcal{O}(n)$</span> implementation from <code>FastGaussQuadrature.jl</code>.</li><li>For other types, we use the arbitrary precision implementation from <code>Arblib.jl</code>, then convert the results to the desired type.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/special_functions/quadrature.jl#L1-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.gaussquad-Union{Tuple{T}, Tuple{Chebyshev{T}, Any}} where T" href="#TransitionMatrices.gaussquad-Union{Tuple{T}, Tuple{Chebyshev{T}, Any}} where T"><code>TransitionMatrices.gaussquad</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">gaussquad(c::Chebyshev{T}, ngauss) where {T}</code></pre><p>Evaluate the quadrature points, weights and the corresponding radius and radius derivative (to <span>$\vartheta$</span>) for a Chebyshev particle.</p><p>Returns: (<code>x</code>, <code>w</code>, <code>r</code>, <code>r′</code>)</p><ul><li><code>x</code>: the quadrature points.</li><li><code>w</code>: the quadrature weights.</li><li><code>r</code>: the radius at each quadrature point.</li><li><code>r′</code>: the radius derivative at each quadrature point.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/shapes/chebyshev.jl#L54-L67">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.gaussquad-Union{Tuple{T}, Tuple{Cylinder{T}, Any}} where T" href="#TransitionMatrices.gaussquad-Union{Tuple{T}, Tuple{Cylinder{T}, Any}} where T"><code>TransitionMatrices.gaussquad</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">gaussquad(c::Cylinder{T}, ngauss) where {T}</code></pre><p>Evaluate the quadrature points, weights and the corresponding radius and radius derivative (to <span>$\vartheta$</span>) for a cylinder.</p><p>Returns: (<code>x</code>, <code>w</code>, <code>r</code>, <code>r′</code>)</p><ul><li><code>x</code>: the quadrature points.</li><li><code>w</code>: the quadrature weights.</li><li><code>r</code>: the radius at each quadrature point.</li><li><code>r′</code>: the radius derivative at each quadrature point.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/shapes/cylinder.jl#L36-L49">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.gaussquad-Union{Tuple{T}, Tuple{Spheroid{T}, Any}} where T" href="#TransitionMatrices.gaussquad-Union{Tuple{T}, Tuple{Spheroid{T}, Any}} where T"><code>TransitionMatrices.gaussquad</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">gaussquad(s::Spheroid{T}, ngauss) where {T}</code></pre><p>Evaluate the quadrature points, weights and the corresponding radius and radius derivative (to <span>$\vartheta$</span>) for a spheroid.</p><p>Returns: (<code>x</code>, <code>w</code>, <code>r</code>, <code>r′</code>)</p><ul><li><code>x</code>: the quadrature points.</li><li><code>w</code>: the quadrature weights.</li><li><code>r</code>: the radius at each quadrature point.</li><li><code>r′</code>: the radius derivative at each quadrature point.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/shapes/spheroid.jl#L36-L49">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.order-Union{Tuple{AbstractTransitionMatrix{CT, N}}, Tuple{N}, Tuple{CT}} where {CT, N}" href="#TransitionMatrices.order-Union{Tuple{AbstractTransitionMatrix{CT, N}}, Tuple{N}, Tuple{CT}} where {CT, N}"><code>TransitionMatrices.order</code></a> — <span class="docstring-category">Method</span></header><section><div><p>Get the maximum order of a T-Matrix.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/common/AbstractTransitionMatrix.jl#L6-L8">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.orientation_average-Tuple{MieTransitionMatrix, Any}" href="#TransitionMatrices.orientation_average-Tuple{MieTransitionMatrix, Any}"><code>TransitionMatrices.orientation_average</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">orientation_average(mie::MieTransitionMatrix, _pₒ; _kwargs...)</code></pre><p>The T-Matrix of a Mie scatterer is invariant under rotation. Therefore, the original T-Matrix will be returned.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/Mie/MieTransitionMatrix.jl#L65-L71">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.orientation_average-Tuple{RandomOrientationTransitionMatrix, Any}" href="#TransitionMatrices.orientation_average-Tuple{RandomOrientationTransitionMatrix, Any}"><code>TransitionMatrices.orientation_average</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">orientation_average(ro::RandomOrientationTransitionMatrix, _pₒ; _kwargs...)</code></pre><p>The random-orientation T-Matrix is invariant under rotation. Therefore, the original T-Matrix will be returned.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/common/RandomOrientationTransitionMatrix.jl#L47-L53">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.orientation_average-Union{Tuple{N}, Tuple{CT}, Tuple{AbstractTransitionMatrix{CT, N}, Any}} where {CT, N}" href="#TransitionMatrices.orientation_average-Union{Tuple{N}, Tuple{CT}, Tuple{AbstractTransitionMatrix{CT, N}, Any}} where {CT, N}"><code>TransitionMatrices.orientation_average</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">orientation_average(𝐓::AbstractTransitionMatrix{CT, N}, pₒ; Nα = 10, Nβ = 10, Nγ = 10) where {CT, N}</code></pre><p>Calculate the orientation average of a transition matrix using numerical integration, given the orientation distribution function <span>$p_o(\alpha,\beta,\gamma)$</span>. </p><p class="math-container">\[\langle T_{m n m^{\prime} n^{\prime}}^{p p^{\prime}}(L)\rangle = \int_0^{2\pi}\mathrm{d}\alpha\int_0^{\pi}\mathrm{d}\beta\sin\beta\int_0^{2\pi}\mathrm{d}\gamma p_o(\alpha,\beta,\gamma) T_{m n m^{\prime} n^{\prime}}^{p p^{\prime}}(L; \alpha,\beta,\gamma)\]</p><p>Parameters:</p><ul><li><code>𝐓</code>: the T-Matrix to be orientation averaged.</li><li><code>pₒ</code>: the orientation distribution function. Note that the <span>$\sin\beta$</span> part is already included.</li><li><code>Nα</code>: the number of points used in the numerical integration of <span>$\alpha$</span>. Default to 10.</li><li><code>Nβ</code>: the number of points used in the numerical integration of <span>$\beta$</span>. Default to 10.</li><li><code>Nγ</code>: the number of points used in the numerical integration of <span>$\gamma$</span>. Default to 10.</li></ul><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>This is the fallback method and does not utilize any symmetry, so it is expected to be slow. You should use specified versions of this function, or implement your own if there is no suited version for your combination of T-Matrix and orientation distribution function.</p><p>You may also need to test the convergence of <code>Nα</code>, <code>Nβ</code> and <code>Nγ</code> manually. If any one is too small, there will be large errors in the results.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/common/AbstractTransitionMatrix.jl#L195-L219">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.phase_matrix-Tuple{AbstractMatrix}" href="#TransitionMatrices.phase_matrix-Tuple{AbstractMatrix}"><code>TransitionMatrices.phase_matrix</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">phase_matrix(𝐒::AbstractMatrix)</code></pre><p>Calculate the phase matrix <code>𝐙</code> from the amplitude matrix <code>𝐒</code>, according to Eq. (2.106) – Eq. (2.121) in Mishchenko et al. (2002).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/common/utils.jl#L58-L64">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.pi_func-Union{Tuple{T}, Tuple{Type{T}, Integer, Integer, Number}} where T" href="#TransitionMatrices.pi_func-Union{Tuple{T}, Tuple{Type{T}, Integer, Integer, Number}} where T"><code>TransitionMatrices.pi_func</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">pi_func([T=Float64,], m::Integer, n::Integer, ϑ::Number; d=nothing)</code></pre><p>Calculate</p><p class="math-container">\[\pi_{m n}(\vartheta)=\frac{m d_{0 m}^n(\vartheta)}{\sin \vartheta}\]</p><ul><li>If <code>d</code> is given, it is used as the value of <span>$d_{0 m}^n(\vartheta)$</span>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/special_functions/wignerd.jl#L339-L351">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.ricattibesselj!-NTuple{6, Any}" href="#TransitionMatrices.ricattibesselj!-NTuple{6, Any}"><code>TransitionMatrices.ricattibesselj!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ricattibesselj!(ψₙ, ψₙ′, z, nₘₐₓ, nₑₓₜᵣₐ, x)</code></pre><p>Parameters:</p><ul><li><code>ψ</code>: output array for <span>$\psi_n(x)$</span>.</li><li><code>ψ′</code>: output array for <span>$\psi^{\prime}_n(x)$</span>.</li><li><code>z</code>: auxiliary array for downward recursion.</li><li><code>nₘₐₓ</code>: maximum order of <span>$\psi_n(x)$</span>.</li><li><code>nₑₓₜᵣₐ</code>: extra terms for downward recursion of <span>$z$</span>.</li><li><code>x</code>: argument.</li></ul><p>In-place version of <a href="#TransitionMatrices.ricattibesselj-Tuple{Integer, Integer, Any}"><code>ricattibesselj</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/special_functions/bessel.jl#L11-L26">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.ricattibesselj-Tuple{Integer, Integer, Any}" href="#TransitionMatrices.ricattibesselj-Tuple{Integer, Integer, Any}"><code>TransitionMatrices.ricattibesselj</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ricattibesselj(nₘₐₓ::Integer, nₑₓₜᵣₐ::Integer, x)</code></pre><p>Calculate Ricatti-Bessel function of the first kind, <span>$\psi_n(x)$</span>, and its derivative <span>$\psi^{\prime}_n(x)$</span> for <span>$1\le n\le n_{\max}$</span>.</p><p><span>$\psi_n(x)$</span> is defined as</p><p class="math-container">\[\psi_n(x) = xj_n(x)\]</p><p>where <span>$j_n(x)$</span> is the Bessel function of the first kind.</p><p>Parameters:</p><ul><li><code>nₘₐₓ</code>: maximum order of <span>$\psi_n(x)$</span>.</li><li><code>nₑₓₜᵣₐ</code>: extra terms for downward recursion of <span>$z$</span>.</li><li><code>x</code>: argument.</li></ul><p>Returns: (<code>ψ</code>, <code>ψ′</code>)</p><ul><li><code>ψ</code>: array of <span>$\psi_n(x)$</span>.</li><li><code>ψ′</code>: array of <span>$\psi^{\prime}_n(x)$</span>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/special_functions/bessel.jl#L47-L72">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.ricattibessely!-NTuple{4, Any}" href="#TransitionMatrices.ricattibessely!-NTuple{4, Any}"><code>TransitionMatrices.ricattibessely!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ricattibessely!(χ, χ′, nₘₐₓ, x)</code></pre><p>Parameters:</p><ul><li><code>χ</code>: output array for <span>$\chi_n(x)$</span>.</li><li><code>χ′</code>: output array for <span>$\chi^{\prime}_n(x)$</span>.</li><li><code>nₘₐₓ</code>: maximum order of <span>$\chi_n(x)$</span>.</li><li><code>x</code>: argument.</li></ul><p>In-place version of <a href="#TransitionMatrices.ricattibessely-Tuple{Any, Any}"><code>ricattibessely</code></a>.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/special_functions/bessel.jl#L103-L116">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.ricattibessely-Tuple{Any, Any}" href="#TransitionMatrices.ricattibessely-Tuple{Any, Any}"><code>TransitionMatrices.ricattibessely</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">ricattibessely(nₘₐₓ::Integer, x)</code></pre><p>Calculate Ricatti-Bessel function of the second kind, <span>$\chi_n(x)$</span>, and its derivative <span>$\chi^{\prime}_n(x)$</span> for <span>$1\le n\le n_{\max}$</span>.</p><p><span>$\chi_n(x)$</span> is defined as</p><p class="math-container">\[\chi_n(x) = xy_n(x)\]</p><p>where <span>$y_n(x)$</span> is the Bessel function of the second kind.</p><p>Parameters:</p><ul><li><code>nₘₐₓ</code>: maximum order of <span>$\chi_n(x)$</span>.</li><li><code>x</code>: argument.</li></ul><p>Returns: (<code>χ</code>, <code>χ′</code>)</p><ul><li><code>χ</code>: Array of <span>$\chi_n(x)$</span>.</li><li><code>χ′</code>: Array of <span>$\chi^{\prime}_n(x)$</span>.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/special_functions/bessel.jl#L130-L154">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.rotate-Tuple{MieTransitionMatrix, Rotations.Rotation{3}}" href="#TransitionMatrices.rotate-Tuple{MieTransitionMatrix, Rotations.Rotation{3}}"><code>TransitionMatrices.rotate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rotate(mie::MieTransitionMatrix, ::Rotation{3})</code></pre><p>The T-Matrix of a Mie scatterer is invariant under rotation. Therefore, the original T-Matrix will be returned.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/Mie/MieTransitionMatrix.jl#L56-L62">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.rotate-Union{Tuple{N}, Tuple{CT}, Tuple{AbstractTransitionMatrix{CT, N}, Rotations.Rotation{3}}} where {CT, N}" href="#TransitionMatrices.rotate-Union{Tuple{N}, Tuple{CT}, Tuple{AbstractTransitionMatrix{CT, N}, Rotations.Rotation{3}}} where {CT, N}"><code>TransitionMatrices.rotate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rotate(𝐓::AbstractTransitionMatrix{CT, N}, rot::Rotation{3})</code></pre><p>Rotate the given T-Matrix <code>𝐓</code> by the Euler angle <code>rot</code> and generate a new T-Matrix.</p><p>For a general T-Matrix, Eq. (5.29) in Mishchenko et al. (2002) is used as a fallback. A <code>TransitionMatrix</code> will be returned, which is the most general yet concrete type.</p><p class="math-container">\[T_{m n m^{\prime} n^{\prime}}^{p p′}(L ; \alpha, \beta, \gamma)=\sum_{m_1=-n}^n \sum_{m_2=-n^{\prime}}^{n^{\prime}} D_{m m_1}^n(\alpha, \beta, \gamma) T_{m_1 n m_2 n^{\prime}}^{p p′}(P) D_{m_2 m^{\prime}}^{n^{\prime}}(-\gamma,-\beta,-\alpha)\quad p,p′=1,2\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/common/AbstractTransitionMatrix.jl#L28-L40">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.rotate-Union{Tuple{V}, Tuple{N}, Tuple{CT}, Tuple{RandomOrientationTransitionMatrix{CT, N, V}, Rotations.Rotation{3}}} where {CT, N, V}" href="#TransitionMatrices.rotate-Union{Tuple{V}, Tuple{N}, Tuple{CT}, Tuple{RandomOrientationTransitionMatrix{CT, N, V}, Rotations.Rotation{3}}} where {CT, N, V}"><code>TransitionMatrices.rotate</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">rotate(ro::RandomOrientationTransitionMatrix{CT, N, V}, ::Rotation{3}) where {CT, N, V}</code></pre><p>The random-orientation T-Matrix is invariant under rotation. Therefore, the original T-Matrix will be returned.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/common/RandomOrientationTransitionMatrix.jl#L38-L44">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.scattering_cross_section-Union{Tuple{AbstractTransitionMatrix{CT, N}}, Tuple{N}, Tuple{CT}, Tuple{AbstractTransitionMatrix{CT, N}, Any}} where {CT, N}" href="#TransitionMatrices.scattering_cross_section-Union{Tuple{AbstractTransitionMatrix{CT, N}}, Tuple{N}, Tuple{CT}, Tuple{AbstractTransitionMatrix{CT, N}, Any}} where {CT, N}"><code>TransitionMatrices.scattering_cross_section</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">scattering_cross_section(𝐓::AbstractTransitionMatrix{CT, N}, λ=2π) where {CT, N}</code></pre><p>Calculate the scattering cross section per particle averaged over the uniform orientation distribution, according to Eq. (5.140) in Mishchenko et al. (2002).</p><p class="math-container">\[\left\langle C_{\mathrm{sca}}\right\rangle=\frac{2 \pi}{k_1^2} \sum_{n=1}^{\infty} \sum_{m=-n}^n \sum_{n^{\prime}=1}^{\infty} \sum_{m^{\prime}=-n^{\prime}}^{n^{\prime}} \sum_{k=1}^2 \sum_{l=1}^2\left|T_{m n m^{\prime} n^{\prime}}^{k l}(P)\right|^2\]</p><p>Parameters:</p><ul><li><code>𝐓</code>: the T-Matrix of the scatterer.</li><li><code>λ</code>: the wavelength of the incident wave in the host medium. Default to 2π.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/common/AbstractTransitionMatrix.jl#L252-L267">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.scattering_cross_section-Union{Tuple{AxisymmetricTransitionMatrix{CT, N, V, T}}, Tuple{T}, Tuple{V}, Tuple{N}, Tuple{CT}, Tuple{AxisymmetricTransitionMatrix{CT, N, V, T}, Any}} where {CT, N, V, T}" href="#TransitionMatrices.scattering_cross_section-Union{Tuple{AxisymmetricTransitionMatrix{CT, N, V, T}}, Tuple{T}, Tuple{V}, Tuple{N}, Tuple{CT}, Tuple{AxisymmetricTransitionMatrix{CT, N, V, T}, Any}} where {CT, N, V, T}"><code>TransitionMatrices.scattering_cross_section</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">scattering_cross_section(axi::AxisymmetricTransitionMatrix{CT, N}, λ=2π) where {CT, N}</code></pre><p>Calculate the scattering cross section per particle averaged over the uniform orientation distribution, according to Eq. (5.141) in Mishchenko et al. (2002).</p><p class="math-container">\[\left\langle C_{\text {sca }}\right\rangle=\frac{2 \pi}{k_1^2} \sum_{n=1}^{\infty} \sum_{n^{\prime}=1}^{\infty} \sum_{m=0}^{\min \left(n, n^{\prime}\right)} \sum_{k=1}^2 \sum_{l=1}^2\left(2-\delta_{m 0}\right)\left|T_{m n m n^{\prime}}^{k l}(P)\right|^2\]</p><p>Parameters:</p><ul><li><code>𝐓</code>: the T-Matrix of the scatterer.</li><li><code>λ</code>: the wavelength of the incident wave in the host medium. Default to 2π.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/EBCM/axisymmetric.jl#L644-L659">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.tau_func-Union{Tuple{T}, Tuple{Type{T}, Integer, Integer, Number}} where T" href="#TransitionMatrices.tau_func-Union{Tuple{T}, Tuple{Type{T}, Integer, Integer, Number}} where T"><code>TransitionMatrices.tau_func</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">tau_func([T=Float64,], m::Integer, n::Integer, ϑ::Number)</code></pre><p>Calculate</p><p class="math-container">\[\tau_{m n}(\vartheta)=\frac{\mathrm{d} d_{0 m}^n(\vartheta)}{\mathrm{d} \vartheta}\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/special_functions/wignerd.jl#L410-L420">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.transition_matrix-Union{Tuple{CT}, Tuple{T}, Tuple{AbstractAxisymmetricShape{T, CT}, Any, Any, Any}} where {T, CT}" href="#TransitionMatrices.transition_matrix-Union{Tuple{CT}, Tuple{T}, Tuple{AbstractAxisymmetricShape{T, CT}, Any, Any, Any}} where {T, CT}"><code>TransitionMatrices.transition_matrix</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">transition_matrix(s::AbstractAxisymmetricShape{T, CT}, λ, nₘₐₓ, Ng) where {T, CT}</code></pre><p>Calculate the T-Matrix for a given scatterer and wavelength, using the given maximum order <code>nₘₐₓ</code> and number of Gauss-Legendre quadrature points <code>Ng</code>.</p><p>Parameters:</p><ul><li><code>s</code>: the axisymmetricsScatterer.</li><li><code>λ</code>: the wavelength.</li><li><code>nₘₐₓ</code>: the maximum order of the T-Matrix.</li><li><code>Ng</code>: the number of Gauss-Legendre quadrature points to be used.</li></ul><p>Returns:</p><ul><li><code>𝐓</code>: an <code>AxisymmetricTransitionMatrix</code> struct representing the T-Matrix.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/EBCM/axisymmetric.jl#L189-L206">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.transition_matrix_m-Union{Tuple{CT}, Tuple{T}, Tuple{Any, AbstractAxisymmetricShape{T, CT}, Any, Any, Any}} where {T, CT}" href="#TransitionMatrices.transition_matrix_m-Union{Tuple{CT}, Tuple{T}, Tuple{Any, AbstractAxisymmetricShape{T, CT}, Any, Any, Any}} where {T, CT}"><code>TransitionMatrices.transition_matrix_m</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">transition_matrix_m(m, s::AbstractAxisymmetricShape{T, CT}, λ, nₘₐₓ, Ng) where {T, CT}</code></pre><p>Calculate the <code>m</code>-th block of the T-Matrix for a given axisymmetric scatterer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/EBCM/axisymmetric.jl#L418-L424">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.transition_matrix_m₀-Union{Tuple{CT}, Tuple{T}, Tuple{AbstractAxisymmetricShape{T, CT}, Any, Any, Any}} where {T, CT}" href="#TransitionMatrices.transition_matrix_m₀-Union{Tuple{CT}, Tuple{T}, Tuple{AbstractAxisymmetricShape{T, CT}, Any, Any, Any}} where {T, CT}"><code>TransitionMatrices.transition_matrix_m₀</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">transition_matrix_m₀(s::AbstractAxisymmetricShape{T, CT}, λ, nₘₐₓ, Ng) where {T, CT}</code></pre><p>Calculate the <code>m=0</code> block of the T-Matrix for a given axisymmetric scatterer.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/EBCM/axisymmetric.jl#L263-L269">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.wigner_D-Union{Tuple{T}, Tuple{Type{T}, Integer, Integer, Integer, Number, Number, Number}} where T" href="#TransitionMatrices.wigner_D-Union{Tuple{T}, Tuple{Type{T}, Integer, Integer, Integer, Number, Number, Number}} where T"><code>TransitionMatrices.wigner_D</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">wigner_D(::Type{T}, m::Integer, m′::Integer, n::Integer, α::Number, β::Number, γ::Number) where {T}</code></pre><p>Calculate the Wigner D-function <span>$D^j_{mn}(\theta)$</span>, which is defined as:</p><p class="math-container">\[D_{m m^{\prime}}^{n}(\alpha, \beta, \gamma)=\mathrm{e}^{-\mathrm{i} m \alpha} d_{m m^{\prime}}^{n}(\beta) \mathrm{e}^{-\mathrm{i} m^{\prime} \gamma}\]</p><p>where</p><p class="math-container">\[0 \leq \alpha&lt;2 \pi, \quad 0 \leq \beta \leq \pi, \quad 0 \leq \gamma&lt;2 \pi\]</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This function easily overflows for large values of <code>s</code>, and it is no faster than the recursive method. It is provided here only for checking the correctness of the recursive method. Users are recommended to use <code>wigner_D_recursion</code> instead.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/special_functions/wignerd.jl#L256-L275">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.wigner_D_recursion!-Union{Tuple{CT}, Tuple{AbstractVector{CT}, Integer, Integer, Integer, Number, Number, Number}} where CT" href="#TransitionMatrices.wigner_D_recursion!-Union{Tuple{CT}, Tuple{AbstractVector{CT}, Integer, Integer, Integer, Number, Number, Number}} where CT"><code>TransitionMatrices.wigner_D_recursion!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">wigner_D_recursion!(d::AbstractVector{CT}, m::Integer, m′::Integer, nmax::Integer, α::Number, β::Number, γ::Number)</code></pre><p>Calculate the Wigner D-function recursively, in place.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/special_functions/wignerd.jl#L305-L311">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.wigner_D_recursion-Union{Tuple{T}, Tuple{Type{T}, Integer, Integer, Integer, Number, Number, Number}} where T" href="#TransitionMatrices.wigner_D_recursion-Union{Tuple{T}, Tuple{Type{T}, Integer, Integer, Integer, Number, Number, Number}} where T"><code>TransitionMatrices.wigner_D_recursion</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">wigner_D_recursion([T=Float64,], m::Integer, m′::Integer, nmax::Integer, α::Number, β::Number, γ::Number)</code></pre><p>Calculate the Wigner D-function recursively (use <code>wigner_d_recursion</code>).</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/special_functions/wignerd.jl#L286-L292">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.wigner_d-Union{Tuple{T}, Tuple{Type{T}, Integer, Integer, Integer, Number}} where T" href="#TransitionMatrices.wigner_d-Union{Tuple{T}, Tuple{Type{T}, Integer, Integer, Integer, Number}} where T"><code>TransitionMatrices.wigner_d</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">wigner_d([T=Float64,], m::Integer, n::Integer, s::Integer, ϑ::Number) where {T}</code></pre><p>Calculate Wigner (small) d-function <span>$d_{mn}^s(\theta)$</span> for a single <span>$(m, n, s)$</span> combination, using Eq. (B.1) of Mishchenko et al. (2002).</p><p class="math-container">\[\begin{aligned}
d_{m n}^{s}(\vartheta)=&amp; \sqrt{(s+m) !(s-m) !(s+n) !(s-n) !} \\
&amp; \times \sum_{k=\max(0,m-n)}^{\min(s + m, s - n)}(-1)^{k} \frac{\left(\cos \frac{1}{2} \vartheta\right)^{2 s-2 k+m-n}\left(\sin \frac{1}{2} \vartheta\right)^{2 k-m+n}}{k !(s+m-k) !(s-n-k) !(n-m+k) !}
\end{aligned}\]</p><div class="admonition is-warning"><header class="admonition-header">Warning</header><div class="admonition-body"><p>This function easily overflows for large values of <code>s</code>, and it is no faster than the recursive method. It is provided here only for checking the correctness of the recursive method. Users are recommended to use <code>wigner_d_recursion</code>` instead.</p></div></div></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/special_functions/wignerd.jl#L3-L19">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.wigner_d_recursion!-Union{Tuple{T}, Tuple{AbstractVector{T}, Integer, Integer, Integer, Number}} where T" href="#TransitionMatrices.wigner_d_recursion!-Union{Tuple{T}, Tuple{AbstractVector{T}, Integer, Integer, Integer, Number}} where T"><code>TransitionMatrices.wigner_d_recursion!</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">wigner_d_recursion!(d::AbstractVector{T}, m::Integer, n::Integer, smax::Integer, ϑ::Number; deriv=nothing)</code></pre><p>Calculate the Wigner d-function recursively, in place.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/special_functions/wignerd.jl#L102-L108">source</a></section></article><article class="docstring"><header><a class="docstring-binding" id="TransitionMatrices.wigner_d_recursion-Union{Tuple{T}, Tuple{Type{T}, Integer, Integer, Integer, Number}} where T" href="#TransitionMatrices.wigner_d_recursion-Union{Tuple{T}, Tuple{Type{T}, Integer, Integer, Integer, Number}} where T"><code>TransitionMatrices.wigner_d_recursion</code></a> — <span class="docstring-category">Method</span></header><section><div><pre><code class="language-julia hljs">wigner_d_recursion([T=Float64,], m::Integer, n::Integer, smax::Integer, ϑ::Number; deriv::Bool = false) where {T}</code></pre><p>Calculate Wigner (small) d-function <span>$d_{mn}^s(\theta)$</span> for <span>$s\in[s_{\min}=\max(|m|, |n|),s_{\max}]$</span> (alternatively, its derivative as well) via upward recursion, using Eq. (B.22) of Mishchenko et al. (2002).</p><p class="math-container">\[\begin{aligned}
d_{m n}^{s+1}(\vartheta)=&amp; \frac{1}{s \sqrt{(s+1)^{2}-m^{2}} \sqrt{(s+1)^{2}-n^{2}}}\left\{(2 s+1)[s(s+1) x-m n] d_{m n}^{s}(\vartheta)\right.\\
&amp;\left.-(s+1) \sqrt{s^{2}-m^{2}} \sqrt{s^{2}-n^{2}} d_{m n}^{s-1}(\vartheta)\right\}, \quad s \geq s_{\min }
\end{aligned}\]</p><p>The initial terms are given by Eq. (B.23) and Eq. (B.24).</p><p class="math-container">\[\begin{array}{l}
d_{m n}^{s_{\min }-1}(\vartheta)=0 \\
d_{m n}^{s_{\min }}(\vartheta)=\xi_{m n} 2^{-s_{\min }}\left[\frac{\left(2 s_{\min }\right) !}{(|m-n|) !(|m+n|) !}\right]^{1 / 2}(1-x)^{|m-n| / 2}(1+x)^{|m+n| / 2}
\end{array}\]</p><p>where</p><p class="math-container">\[\xi_{m n}=\left\{\begin{array}{ll}
1 &amp; \text { for } n \geq m \\
(-1)^{m-n} &amp; \text { for } n&lt;m
\end{array}\right.\]</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/lucifer1004/TransitionMatrices.jl/blob/1c6f27b3cf38e1b96fd493668b52f05471d2e1fa/src/special_functions/wignerd.jl#L54-L85">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../">« Home</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 0.27.24 on <span class="colophon-date" title="Monday 13 March 2023 02:39">Monday 13 March 2023</span>. Using Julia version 1.8.5.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
